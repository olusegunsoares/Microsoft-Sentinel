To detect file access or modification (Event ID 4663), enable the Audit Policy for File Access via gpedit.msc, navigate to Advanced Audit Policy Configuration → Object Access, and enable Audit File System for both success and failure events; then create and configure auditing for a monitored folder (Very Secret) by setting Testadmin as the principal, applying full auditing permissions, and ensuring logs capture access attempts; finally, return to the Azure portal, open Logs in Microsoft Sentinel, and run a KQL query to check for file access and modification logs.
To monitor modifications in the Very Secret folder, run a KQL query in Microsoft Sentinel Logs to filter for Event ID 4663, specifically targeting file access events within the designated path; then, create an alert rule for file deletion events by navigating to + New alert rule > Create Microsoft Sentinel alert, configure it in the Analytics rule wizard under General configuration with the name Suspicious_file_access, set the Severity to High, assign the MITRE ATT&CK technique (T1041 – Exfiltration over C2 Channel), and define the KQL query to detect deletion attempts based on AccessMask 0x10000; once saved, verify the rule creation in the Analytics section, delete Confidential.txt from the Very Secret folder on the VM, wait for approximately 10-11 minutes, and check the Incidents section in Microsoft Sentinel for a new alert.
